<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{layout}" lang="en">
<head>
    <title th:text="${movie.title} + ' - Cinema App'"></title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/glightbox/dist/css/glightbox.min.css" />
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.0/font/bootstrap-icons.css">
    <script src="https://cdn.jsdelivr.net/gh/mcstudios/glightbox/dist/js/glightbox.min.js"></script>
</head>
<body>
    <div layout:fragment="content">
        <!-- Backdrop Hero -->
        <div class="movie-backdrop-hero" th:style="'background-image: url(/uploads/' + ${movie.backdropFileName} + ')'">
            <div class="movie-info-overlay">
                <h1 th:text="${movie.title}"></h1>
                <div class="movie-meta">
                    <span class="badge bg-info" th:text="${movie.genre}"></span>
                    <span class="badge bg-secondary" th:text="${movie.releaseYear}"></span>
                    <span class="badge bg-danger" th:text="'Age ' + ${movie.ageRestriction} + '+'"></span>
                    <span class="badge bg-primary" th:text="${movie.durationInMinutes} + ' min'"></span>
                </div>
            </div>
        </div>

        <!-- Movie Details Section -->
        <div class="movie-poster-section">
            <div class="movie-poster">
                <img th:src="@{/uploads/{fileName}(fileName=${movie.posterFileName})}"
                     alt="Poster">
            </div>
            <div class="movie-details-content">

                <div class="movie-description mb-5">
                    <h3 class="text-white mb-3">Overview</h3>
                    <p class="lead text-light-grey" th:text="${movie.description}"></p>
                </div>

                <div class="movie-meta-grid">

                    <div class="meta-item">
                        <div class="meta-icon">
                            <i class="bi bi-megaphone-fill"></i>
                        </div>
                        <div class="meta-content">
                            <span class="meta-label">Director</span>
                            <span class="meta-value" th:text="${movie.director}"></span>
                        </div>
                    </div>

                    <div class="meta-item">
                        <div class="meta-icon">
                            <i class="bi bi-globe-americas"></i>
                        </div>
                        <div class="meta-content">
                            <span class="meta-label">Production Country</span>
                            <span class="meta-value" th:text="${movie.productionCountry}"></span>
                        </div>
                    </div>

                    <div class="meta-item full-width">
                        <div class="meta-icon">
                            <i class="bi bi-people-fill"></i>
                        </div>
                        <div class="meta-content">
                            <span class="meta-label">Cast</span>
                            <span class="meta-value text-highlight" th:text="${movie.cast}"></span>
                        </div>
                    </div>

                </div>

                <!-- Trailer -->
                <div th:if="${movie.trailerYoutubeUrl != null}" class="mt-4">

                    <h3 class="section-header">Trailer</h3>

                    <a th:href="${movie.trailerYoutubeUrl}"
                       class="glightbox btn btn-danger btn-lg d-inline-flex align-items-center gap-2">

                        <i class="bi bi-play-circle-fill"></i> Watch Trailer
                    </a>

                </div>
            </div>
        </div>

        <!-- Gallery -->
        <div th:if="${movie.galleryImageNames != null and !movie.galleryImageNames.isEmpty()}" class="container mt-5 mb-5 centered-content">

            <h3 class="section-header">Gallery</h3>

            <div class="row g-3">

                <div class="col-6 col-md-4 col-lg-3">
                    <a th:href="@{'/uploads/' + ${movie.posterFileName}}"
                       class="glightbox"
                       data-gallery="movie-gallery"
                       data-type="image"
                       th:data-description="${movie.title} + ' - Official Poster'">

                        <div class="gallery-item">
                            <img th:src="@{'/uploads/' + ${movie.posterFileName}}"
                                 class="gallery-image"
                                 alt="Movie Poster">

                            <div class="gallery-overlay">
                                <i class="bi bi-zoom-in"></i>
                            </div>
                        </div>
                    </a>
                </div>

                <div class="col-6 col-md-4 col-lg-3" th:each="imageName : ${movie.galleryImageNames}">
                    <a th:href="@{'/uploads/' + ${imageName}}"
                       class="glightbox"
                       data-gallery="movie-gallery"
                       data-type="image">

                        <div class="gallery-item">
                            <img th:src="@{'/uploads/' + ${imageName}}"
                                 class="gallery-image"
                                 alt="Scene from movie">

                            <div class="gallery-overlay">
                                <i class="bi bi-zoom-in"></i>
                            </div>
                        </div>
                    </a>
                </div>

            </div>
        </div>

        <!-- Back Button -->
        <div class="btn-back centered-content btn-back-wrapper">
            <a th:href="@{/movies}" class="btn btn-outline-secondary">‚Üê Back to Movies</a>
        </div>
    </div>
    <th:block layout:fragment="scripts">
        <script src="https://cdn.jsdelivr.net/npm/mdb-ui-kit/dist/mdb.umd.js"></script>
        <script type="text/javascript">
            document.addEventListener('DOMContentLoaded', () => {
                const lightbox = GLightbox({
                    selector: '.glightbox',
                    touchNavigation: true,
                    loop: true,
                    autoplayVideos: true
                });
            });
        </script>
    </th:block>
</body>
</html>